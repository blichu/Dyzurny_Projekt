<html>
<head>
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-1.12.3.js"></script>
    <script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
</head>
<body>
<div id="addForm">
    <form action="javascript:addData()">
        <table>
            <tr>
                <td>Imię</td>
                <td><input type="text" id="nameField"/><br/></td>
            </tr>
            <tr>
                <td>Nazwisko</td>
                <td><input type="text" id="surnameField"/><br/></td>
            </tr>
            <tr>
                <td>Avatar</td>
                <td><input type="text" id="avatarField" name="imagePath" size="9" disabled="disabled"/>
                    <button type="button">Wybierz...</button>
                    <br/></td>
            </tr>
            <tr>
                <td>
                    <button type="submit">Dodaj</button>
                    <button type="reset">Reset</button>
                </td>
            </tr>
        </table>
    </form>
</div>
<div id="removeForm">
    <table>
        <tr>
            <td>
                Imię
            </td>
            <td>
                <select name="nameSelect">

                </select>
            </td>
        </tr>
        <tr>
            <td>
                Nazwisko
            </td>
            <td>
                <select name="surnameSelect">

                </select>
            </td>
        </tr>
        <tr>
            <td>
                <button type="submit" id="deleteButton">Usuń</button>
                <button type="reset">Reset</button>
            </td>
        </tr>
    </table>
</div>
<table id="example" class="display" cellspacing="0" width="100%">
    <thead>
    <tr>
        <th>Avatar</th>
        <th>Name</th>
        <th>Surname</th>
    </tr>
    </thead>
    <tfoot>
    <tr>
        <th>Avatar</th>
        <th>Name</th>
        <th>Surname</th>
    </tr>
    </tfoot>
    <tbody id="tbodyy">
    <script>
        var response;

        $(document).ready(function () {
            loadData();
//            addData("x", "y");
        });

        function loadData() {
            $.get("http://192.168.15.105:3000/lol", function (r) {
                response = r;
                for (var i = 0; i < response.length; i++) {
                    $("#tbodyy").append("<tr><td><img class=\"avatars\" src=" + response[i].avatarLink + "></td><td>" + response[i].name + "</td>" + "<td>" + response[i].surname + "</td></tr>");
                }
//                $('#example').dataTable({
//                    select: true,
//                    "columnDefs": [
//                        {"width": "5%", "targets": 0}
//                    ]
//                });
                $(document).ready(function() {
                    var table = $('#example').dataTable({
//                        select: true,
                        "columnDefs": [
                            {"width": "5%", "targets": 0}
                        ]
                    });
                    $('#example tbody').on( 'click', 'tr', function () {
                        if ( $(this).hasClass('selected') ) {
                            $(this).removeClass('selected');
                        }
                        else {
                            table.$('tr.selected').removeClass('selected');
                            $(this).addClass('selected');
                        }
                    } );

                    $('#deleteButton').click( function () {
                        removeData();
//                        table.row('.selected').remove().draw( false );
                    } );
                } );
            })
        };
        function addData() {
            $.ajax({
                type: 'POST',
                url: 'http://192.168.15.105:3000/lol',
                data:
                '{"name":"' +
                $('#nameField').val() +
                '", "surname":"' +
                $('#surnameField').val() +
                '", "avatar":"' +
                $('#avatarField').val() +
                '"}',
                success: function(data) { alert('data: ' + data); },
                contentType: "application/json",
                dataType: 'json'
            });
        }
        function removeData() {
            $.ajax({
                type: 'DELETE',
                url: 'http://192.168.15.105:3000/lol',
                data: '{"id":"1"}',
                success: function(data) { alert('data: ' + data); },
                error: function (data) {alert('deleteFail');},
                contentType: "application/json",
                dataType: 'json'
            });
        }
    </script>
    </tbody>
</table>


</body>
</html>